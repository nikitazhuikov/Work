SELECT 
    -- Столбцы из основной таблицы и справочников
    reg.[Name] AS [Субъект Российской Федерации],
    main.[Направление_мероприятий] as [Принадлежность к проекту],
    razd.[Name] AS [Наименование раздела],
    main.[Номер_мероприятия],
    main.[Наименование_мероприятия],
    main.[Начало_реализации],
    main.[Окончание_реализации],
    main.[Характеристика_результата],
    main.[Планируемый_результат_исполнения_мероприятия_на_конец_отчетного_года],
    main.[Планируемый_результат_исполнения_мероприятия_на_конец_отчетного_года_число_текстом],
    hist.[Комментарий_о_реализации_мероприятия],
    hist.[Процент_исполнения_мероприятия],
    stat.[Name] AS [Статус],
    prob.[Name] AS [Проблемы],
    hist.[Описание_проблем],
    resh.[Name] AS [Решения],
    hist.[Описание_решений],
    hist.[Комментарий_НМИЦ___оценка],
    hist.[Комментарий_НМИЦ___комментарий],
    dict_main.[DIT_NAME] AS [Статус мероприятия (основной)],
    dict_hist.[DIT_NAME] AS [Статус мероприятия (история)],
    hist.[Отчётная_дата]
FROM 
    [ASMMS].[dbo].[_Мониторинг_РП_основная_сущность_СД] main
    
    -- Связь 1 ко многим с историей
    LEFT JOIN [ASMMS].[dbo].[_Мониторинг_РП_СД_история] hist 
        ON main.[Id] = hist.[id_main_object]
    
    -- Связь 1 к 1 с регионом
    INNER JOIN [ASMMS].[dbo].[_Регион] reg 
        ON main.[Регион] = reg.[Id]
    
    -- Связь 1 к 1 со справочником статусов мероприятия (для основной таблицы)
    LEFT JOIN [ASMMS].[dbo].[DICTIONARY_ITEMS] dict_main 
        ON main.[Статус_мероприятия] = dict_main.[DIT_ID]
    
    -- Связь 1 к 1 со справочником статусов мероприятия (для истории)
    LEFT JOIN [ASMMS].[dbo].[DICTIONARY_ITEMS] dict_hist 
        ON hist.[Статус_мероприятия] = dict_hist.[DIT_ID]
    
    -- Связь 1 к 1 со статусами отчёта
    LEFT JOIN [ASMMS].[dbo].[_Мониторинг_РП_статусы] stat 
        ON hist.[Статус] = stat.[Id]
    
    -- Связь 1 к 1 с проблемами
    LEFT JOIN [ASMMS].[dbo].[_Мониторинг_РП_проблемы] prob 
        ON hist.[Проблемы] = prob.[Id]
    
    -- Связь 1 к 1 с решениями
    LEFT JOIN [ASMMS].[dbo].[_Мониторинг_РП_решения] resh 
        ON hist.[Решения] = resh.[Id]
    
    -- Связь с разделами (если есть такое поле)
    LEFT JOIN [ASMMS].[dbo].[_Мониторинг_РП_разделы] razd 
        ON main.[Раздел] = razd.[Id]

ORDER BY 
    reg.[Name],
    main.[Номер_мероприятия],
    hist.[Отчётная_дата];