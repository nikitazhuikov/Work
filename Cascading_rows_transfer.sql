CREATE PROCEDURE [dbo].[usp_CascadingRowsTransfer]
    @Year_previous INT,
    @Period_previous INT,
    @Year_next INT,
    @Period_next INT
AS
BEGIN
    SET NOCOUNT ON;
    SET XACT_ABORT ON;

    BEGIN TRAN;

    INSERT INTO [ASMMS].[dbo].[_Тиражирование_практики] (
        [Дата_последнего_пересмотра_лучшей_практики],
        [Лучшая_практика_утверждена_в_качестве_регионального_стандарта],
        [Лучшая_практика_актуальна],
        [Новое],
        [Регион],
        [id_main_object],
        [main_object],
        [Лучшая_практика],
        [Вид_документа],
        [Орган_исполнительной_власти_субъекта_Российской_Федерации_утвердивший_документ],
        [Дата_утверждения_документа_тиражирование],
        [Номер_документа_тиражирование],
        [Наименование_документа_на_основании_которого_выполняется_тиражирование_лучшей_практики_в_МО],
        [Документ_на_основании_которого_выполняется_тиражирование_лучшей_практики_в_МО],
        [Дата_начала_тиражирования_лучшей_практики_в_МО_субъекта_РФ],
        [Плановая_дата_завершения_тиражирования_лучшей_практики_в_МО_субъекта_РФ],
        [Фактическая_дата_завершения_тиражирования_лучшей_практики_в_субъекте_РФ],
        [Количество_МО_в_которых_запланировано_тиражирование_лучшей_практики],
        [Количество_МО_завершивших_тиражирование_с_достижением_значений_показателей_лучшей_практики],
        [Экономический_эффект_полученный_по_результатам_тиражирования_лучшей_практики],
        [Вид_документа_Региональный_стандарт],
        [Орган_исполнительной_власти_субъекта_Российской_Федерации_утвердивший_документ_Региональный_стандарт],
        [Дата_утверждения_документа_Региональный_стандарт],
        [Номер_документа_Региональный_стандарт],
        [Наименование_документа_на_основании_которого_ЛП_утверждена_в_качестве_регионального_стандарта],
        [Документ_на_основании_которого_лучшая_практика_утверждена_в_качестве_регионального_стандарта],
        [Обслуживаемое_население],
        [Учреждение],
        [check],
        [Календарный_год],
        [Период],
        [Добавление_записей_в_Исходные_значения],
        [Тиражирование_представление],
        [Тиражирование_исходные_значения_фильтр],
        [ФП_ПТЗ_организации]
    )
    SELECT
        [Дата_последнего_пересмотра_лучшей_практики],
        [Лучшая_практика_утверждена_в_качестве_регионального_стандарта],
        [Лучшая_практика_актуальна],
        [Новое],
        [Регион],
        [id_main_object],
        [main_object],
        [Лучшая_практика],
        [Вид_документа],
        [Орган_исполнительной_власти_субъекта_Российской_Федерации_утвердивший_документ],
        [Дата_утверждения_документа_тиражирование],
        [Номер_документа_тиражирование],
        [Наименование_документа_на_основании_которого_выполняется_тиражирование_лучшей_практики_в_МО],
        [Документ_на_основании_которого_выполняется_тиражирование_лучшей_практики_в_МО],
        [Дата_начала_тиражирования_лучшей_практики_в_МО_субъекта_РФ],
        [Плановая_дата_завершения_тиражирования_лучшей_практики_в_МО_субъекта_РФ],
        [Фактическая_дата_завершения_тиражирования_лучшей_практики_в_субъекте_РФ],
        [Количество_МО_в_которых_запланировано_тиражирование_лучшей_практики],
        [Количество_МО_завершивших_тиражирование_с_достижением_значений_показателей_лучшей_практики],
        [Экономический_эффект_полученный_по_результатам_тиражирования_лучшей_практики],
        [Вид_документа_Региональный_стандарт],
        [Орган_исполнительной_власти_субъекта_Российской_Федерации_утвердивший_документ_Региональный_стандарт],
        [Дата_утверждения_документа_Региональный_стандарт],
        [Номер_документа_Региональный_стандарт],
        [Наименование_документа_на_основании_которого_ЛП_утверждена_в_качестве_регионального_стандарта],
        [Документ_на_основании_которого_лучшая_практика_утверждена_в_качестве_регионального_стандарта],
        [Обслуживаемое_население],
        [Учреждение],
        [check],
        @Year_next,
        @Period_next,
        [Добавление_записей_в_Исходные_значения],
        [Тиражирование_представление],
        [Тиражирование_исходные_значения_фильтр],
        [ФП_ПТЗ_организации]
    FROM [ASMMS].[dbo].[_Тиражирование_практики]
    WHERE [Календарный_год] = @Year_previous
      AND [Период] = @Period_previous;

    COMMIT TRAN;
END;
GO
